<% content_for(:title, "合同关闭") %>
<% content_for(:page_header_description, "关闭已经施工完成的合同") %>
<table id="_table_contract" class="table table-striped table-bordered table-hover">
  <thead>
  <tr>
    <th>合同编号</th>
    <th>合同名称</th>
    <th>项目名称</th>
    <th>业主</th>
    <th>乙方</th>
    <th>合同金额</th>
    <th>开始日期</th>
    <th>完成日期</th>
    <th>合同状态</th>
    <th>操作</th>
  </tr>
</thead>
<tbody></tbody>
</table>
<br />
</div>
<div id="_close_modal" class="modal hide fade widget-box">
  <div class="model-header widget-header widget-header-flat">
    <h5>您确认需要关闭该钻孔吗</h5>
    <div class="widget-toolbar">
      <label>
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
     </label>
    </div>
  </div>
  <div class="modal-body widget-body">
    <p> 合同名称:<span id="_contract_name" class="label label-important"></span></p>
    <p> 项目名称:<span id="_project_name"class="label label-important"></span></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal"><i class="icon-undo"></i>否</button>
    <a href="#"  class="btn btn-primary" onclick="close_contract()"><i class="icon-ok"></i>是</a>
  </div>
</div>
<% content_for :page_specific_javascripts do %>
  <%= javascript_include_tag 'jquery.dataTables.min' %>
  <%= javascript_include_tag 'jquery.dataTables.bootstrap' %>
<% end %>

<% content_for :inline_javascripts do %>
<script language="javascript">
  var _contractno; 
  $(function(){
      var oTable1=$("#_table_contract").dataTable({
        "aoColumns":[null,null,null,null,null,null,null,null,null,{"bSortable":false}],
        "bServerSide":true,
        "bAutoWidth" :false,
        "sAjaxSource":"<%=contracts_indexforclose_path(:format=>:json) %>",
        "oLanguage":{
        "sLengthMenu":"每页 _MENU_",
        "sZeroRecords":"对不起,没有数据",
        "sInfo":"显示 _START_ 到 _END_ ,总计_TOTAL_数据",
        "sInfoEmpty":"显示 0 到 0 , 总计0条数据",
        "sSearch": "检索",
        "sProcessing": "系统正在处理...",
        "sInfoFiltered":"(过滤_MAX_数据)" }
        }
        );
  });

  function open_modal(contractno,contractname,projectname)
  {
    _contractno = contractno; 
    $("#_contract_name").html(contractname);
    $("#_project_name").html(projectname);
    $("#_close_modal").modal();
  }

  function close_contract()
  {
    //alert("the contractno is:"+ _contractno);
    window.location.href="<%=contracts_close_path%>?contractno=" + _contractno;
  }
</script>

<% end %>
